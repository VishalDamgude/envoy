admin:
  access_log_path: /tmp/admin_access.log
  address:
    socket_address: { address: 127.0.0.1, port_value: 9901 }

static_resources:
  listeners:
    - name: smtp
      address:
        socket_address: { address: 127.0.0.1, port_value: 10000 }

      filter_chains:
      - filters:
        - name: envoy.filters.network.smtp_proxy
          typed_config:
            "@type": type.googleapis.com/envoy.extensions.filters.network.smtp_proxy.v3alpha.SmtpProxy
            stat_prefix: smtpstat
            terminate_tls: false
        - name: envoy.tcp_proxy
          typed_config:
            "@type": type.googleapis.com/envoy.extensions.filters.network.tcp_proxy.v3.TcpProxy
            stat_prefix: smtp_tcp
            cluster: smtp_cluster

        transport_socket:
          name: envoy.transport_sockets.starttls
          typed_config:
            "@type": type.googleapis.com/envoy.extensions.transport_sockets.starttls.v3.StartTlsConfig
            tls_socket_config:
              common_tls_context:
                tls_certificates:
                - certificate_chain:
                    filename: "myfreshworks.com.cer.pem"
                  private_key:
                    filename: "myfreshworks.com.key.pem"

  clusters:
  - name: smtp_cluster
    connect_timeout: 0.25s
    type: STATIC
    lb_policy: ROUND_ROBIN
    load_assignment:
      cluster_name: smtp_cluster
      endpoints:
      - lb_endpoints:
        - endpoint:
            address:
              socket_address:
                address: 127.0.0.1
                port_value: 1025